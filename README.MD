# ğŸŒ® Sistema de GestiÃ³n para TaquerÃ­a - VersiÃ³n Profesional

[![Python](https://img.shields.io/badge/Python-3.11-blue.svg)](https://www.python.org/)
[![Flask](https://img.shields.io/badge/Flask-3.0-green.svg)](https://flask.palletsprojects.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

Sistema completo de gestiÃ³n de Ã³rdenes para taquerÃ­as con roles diferenciados, auditorÃ­a completa y diseÃ±o profesional.

## ğŸš€ Demo en Vivo

**URL:** [https://taqueria-pro.onrender.com](https://taqueria-pro.onrender.com)

**Credenciales de prueba:**
- Usuario: `admin`
- ContraseÃ±a: `admin123`

## âœ¨ CaracterÃ­sticas Principales

### ğŸ” Sistema de AutenticaciÃ³n
- Registro abierto para meseros, cocina y caja
- ContraseÃ±as hasheadas con PBKDF2-SHA256
- Sesiones seguras con cookies HttpOnly
- Control de roles con decoradores
- Registro de Ãºltimo acceso

### ğŸ‘¨â€ğŸ³ Panel de Cocina
- CÃ³digo Ãºnico de 6 caracteres
- Vista de Ã³rdenes pendientes en tiempo real
- Auto-actualizaciÃ³n cada 5 segundos
- Marcado de Ã³rdenes servidas
- Contador de Ã³rdenes activas
- Vista detallada de items por orden

### ğŸ½ï¸ Panel de Mesero
- Sistema de enlace con cocina por cÃ³digo
- CreaciÃ³n de Ã³rdenes en borrador
- Agregado de items con notas especiales
- EnvÃ­o de Ã³rdenes a cocina
- Vista de Ã³rdenes activas
- LÃ­mites automÃ¡ticos (30 tacos, 15 bebidas por mesa)

### ğŸ’° Panel de Caja
- Vista de Ã³rdenes servidas
- Cierre de Ã³rdenes con confirmaciÃ³n
- GeneraciÃ³n de tickets en formato TXT
- CÃ¡lculo automÃ¡tico de totales
- Vista detallada de consumo

### ğŸ‘‘ Panel de AdministraciÃ³n
- CRUD completo de usuarios
- CRUD de productos con categorÃ­as
- CRUD de mesas
- Log de auditorÃ­a detallado
- EstadÃ­sticas globales
- Vista de todas las Ã³rdenes

## ğŸ› ï¸ Stack TecnolÃ³gico

### Backend
- **Framework:** Flask 3.0
- **Base de Datos:** SQLite con Ã­ndices optimizados
- **AutenticaciÃ³n:** Werkzeug Security
- **Servidor:** Gunicorn con workers multi-thread

### Frontend
- **HTML5** con templates Jinja2
- **CSS3** con variables CSS y animaciones
- **JavaScript** vanilla (sin frameworks)
- **DiseÃ±o:** Responsive mobile-first

### Deployment
- **Plataforma:** Render.com
- **Plan:** Free tier
- **Persistencia:** Disco integrado de Render

## ğŸ“¦ InstalaciÃ³n Local

### Requisitos Previos
- Python 3.11+
- pip
- git

### Pasos de InstalaciÃ³n

```bash
# 1. Clonar el repositorio
git clone https://github.com/tu-usuario/taqueria-pro.git
cd taqueria-pro

# 2. Crear entorno virtual
python -m venv venv

# 3. Activar entorno virtual
# En Windows:
venv\Scripts\activate
# En Linux/Mac:
source venv/bin/activate

# 4. Instalar dependencias
pip install -r requirements.txt

# 5. Inicializar base de datos
python init_db.py

# 6. Ejecutar servidor de desarrollo
python app.py

# 7. Abrir en navegador
# http://localhost:5000
```

## ğŸš€ Despliegue en Render

### OpciÃ³n 1: Deploy AutomÃ¡tico

1. Fork este repositorio
2. Crear cuenta en [Render.com](https://render.com)
3. Click en "New +" â†’ "Web Service"
4. Conectar tu repositorio
5. Render detectarÃ¡ automÃ¡ticamente `render.yaml`
6. Click en "Create Web Service"
7. Esperar 3-5 minutos

### OpciÃ³n 2: Deploy Manual

1. Ir a [Render Dashboard](https://dashboard.render.com)
2. New + â†’ Web Service
3. Configurar:
   - **Name:** `taqueria-pro`
   - **Region:** Seleccionar la mÃ¡s cercana
   - **Branch:** `main`
   - **Runtime:** Python 3
   - **Build Command:** 
     ```bash
     pip install -r requirements.txt && python init_db.py
     ```
   - **Start Command:**
     ```bash
     gunicorn app:app --bind 0.0.0.0:$PORT
     ```
   - **Instance Type:** Free

4. Variables de entorno (opcional):
   - `SECRET_KEY`: Se genera automÃ¡ticamente
   - `FLASK_ENV`: `production`

5. Click en "Create Web Service"

## ğŸ“š Estructura del Proyecto

```
taqueria-pro/
â”œâ”€â”€ app.py                 # Backend Flask principal
â”œâ”€â”€ init_db.py            # Script de inicializaciÃ³n de BD
â”œâ”€â”€ requirements.txt      # Dependencias Python
â”œâ”€â”€ render.yaml          # ConfiguraciÃ³n Render
â”œâ”€â”€ .gitignore           # Archivos ignorados por git
â”œâ”€â”€ README.md            # DocumentaciÃ³n
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css    # Estilos profesionales
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ utils.js     # Utilidades JavaScript
â”‚       â””â”€â”€ app.js       # JavaScript principal
â””â”€â”€ templates/
    â”œâ”€â”€ base.html        # Template base
    â”œâ”€â”€ login.html       # PÃ¡gina de login
    â”œâ”€â”€ register.html    # PÃ¡gina de registro
    â”œâ”€â”€ mesero.html      # Panel mesero
    â”œâ”€â”€ cocina.html      # Panel cocina
    â”œâ”€â”€ caja.html        # Panel caja
    â””â”€â”€ admin.html       # Panel admin
```

## ğŸ—„ï¸ Modelo de Datos

### Tablas Principales

#### users
```sql
- id (PK)
- username (UNIQUE)
- password (HASH)
- role (admin|mesero|cocina|caja)
- is_active (BOOLEAN)
- created_at (TIMESTAMP)
- last_login (TIMESTAMP)
```

#### orders
```sql
- id (PK)
- mesero_id (FK â†’ users)
- codigo_cocina (FK â†’ cocinas)
- status (borrador|pendiente|servida|cerrada|cancelada)
- total (DECIMAL)
- created_at (TIMESTAMP)
```

#### order_items
```sql
- id (PK)
- order_id (FK â†’ orders)
- product_id (FK â†’ products)
- qty (INTEGER)
- unit_price (DECIMAL)
- subtotal (GENERATED COLUMN)
- notes (TEXT)
```

#### audit_log
```sql
- id (PK)
- usuario (TEXT)
- accion (TEXT)
- detalle (TEXT)
- ip_address (TEXT)
- timestamp (TIMESTAMP)
```

## ğŸ”’ Seguridad

- âœ… ContraseÃ±as hasheadas con PBKDF2-SHA256
- âœ… Sesiones seguras con cookies HttpOnly
- âœ… ProtecciÃ³n CSRF con tokens
- âœ… ValidaciÃ³n de inputs server-side
- âœ… Control de acceso basado en roles
- âœ… AuditorÃ­a completa de acciones
- âœ… Rate limiting implÃ­cito en Render
- âœ… HTTPS obligatorio en producciÃ³n

## ğŸ“Š CaracterÃ­sticas Avanzadas

### Auto-actualizaciÃ³n Inteligente
```javascript
// Actualiza solo cuando la pÃ¡gina estÃ¡ visible
const autoRefresh = new AutoRefresh(fetchOrders, 5000);
autoRefresh.start();
```

### Sistema de Notificaciones
```javascript
showToast('Orden creada correctamente', 'success');
showToast('Error al procesar', 'error', 5000);
```

### Validaciones AutomÃ¡ticas
- LÃ­mites por mesa (30 tacos, 15 bebidas)
- ValidaciÃ³n de cÃ³digos de cocina
- VerificaciÃ³n de permisos por rol
- ValidaciÃ³n de formularios

## ğŸ¨ PersonalizaciÃ³n

### Colores del Sistema
Editar en `static/css/style.css`:
```css
:root {
    --primary: #2563eb;        /* Azul principal */
    --secondary: #10b981;      /* Verde secundario */
    --danger: #ef4444;         /* Rojo peligro */
    --warning: #f59e0b;        /* Amarillo advertencia */
}
```

### LÃ­mites de Productos
Editar en `app.py`:
```python
MAX_TACOS_POR_MESA = 30
MAX_BEBIDAS_POR_MESA = 15
```

## ğŸ› SoluciÃ³n de Problemas

### Error: Base de datos bloqueada
```bash
rm taqueria.db
python init_db.py
```

### Error: MÃ³dulo no encontrado
```bash
pip install -r requirements.txt --upgrade
```

### Error en Render: Build failed
1. Verificar que `requirements.txt` estÃ© correcto
2. Revisar logs en Render Dashboard
3. Asegurar que Build Command incluya `python init_db.py`

### No se ven cambios en producciÃ³n
```bash
git add .
git commit -m "Update"
git push origin main
# Render auto-desplegarÃ¡ en 2-3 minutos
```

## ğŸ“ˆ PrÃ³ximas Mejoras

- [ ] Reportes en PDF
- [ ] Dashboard con grÃ¡ficas
- [ ] Notificaciones push
- [ ] App mÃ³vil React Native
- [ ] Multi-sucursal
- [ ] IntegraciÃ³n con impresoras tÃ©rmicas
- [ ] Sistema de reservaciones
- [ ] Programa de lealtad

## ğŸ¤ Contribuir

Las contribuciones son bienvenidas:

1. Fork el proyecto
2. Crea una rama (`git checkout -b feature/AmazingFeature`)
3. Commit cambios (`git commit -m 'Add AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

## ğŸ“ Licencia

Este proyecto estÃ¡ bajo la Licencia MIT - ver [LICENSE](LICENSE) para detalles.

## ğŸ‘¨â€ğŸ’» Autor

Desarrollado con â¤ï¸ para modernizar la gestiÃ³n de taquerÃ­as.

## ğŸ“ Soporte

Â¿Necesitas ayuda?
- ğŸ“§ Email: soporte@taqueria-pro.com
- ğŸ’¬ GitHub Issues: [Abrir issue](https://github.com/tu-usuario/taqueria-pro/issues)
- ğŸ“– DocumentaciÃ³n: [Wiki](https://github.com/tu-usuario/taqueria-pro/wiki)

---

â­ Si te gusta este proyecto, dale una estrella en GitHub!